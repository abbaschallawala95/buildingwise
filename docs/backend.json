{
  "entities": {
    "Building": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Building",
      "type": "object",
      "description": "Represents a building managed within the application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the building."
        },
        "buildingName": {
          "type": "string",
          "description": "Name of the building."
        },
        "address": {
          "type": "string",
          "description": "Address of the building."
        },
        "openingBalance": {
          "type": "number",
          "description": "The initial or opening balance for the building."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the building was created.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "buildingName",
        "address",
        "createdAt"
      ]
    },
    "Member": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Member",
      "type": "object",
      "description": "Represents a member (resident) of a building.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the member."
        },
        "buildingId": {
          "type": "string",
          "description": "Reference to Building. (Relationship: Building 1:N Member)"
        },
        "fullName": {
          "type": "string",
          "description": "Full name of the member."
        },
        "flatNumber": {
          "type": "string",
          "description": "Flat number of the member."
        },
        "floor": {
          "type": "string",
          "description": "Floor number where the member resides."
        },
        "contactNumber": {
          "type": "string",
          "description": "Contact number of the member."
        },
        "monthlyMaintenance": {
          "type": "number",
          "description": "The monthly maintenance amount for the member."
        },
        "previousDues": {
          "type": "number",
          "description": "Any previous outstanding dues of the member."
        },
        "maintenanceStartDate": {
          "type": "string",
          "description": "The date when maintenance charges start for the member.",
          "format": "date-time"
        },
        "maintenanceEndDate": {
          "type": "string",
          "description": "The date when maintenance charges end for the member.",
          "format": "date-time"
        },
        "monthlyDueDate": {
          "type": "number",
          "description": "The day of the month when the maintenance payment is due."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the member was added.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "buildingId",
        "fullName",
        "flatNumber",
        "floor",
        "contactNumber",
        "monthlyMaintenance",
        "previousDues",
        "maintenanceStartDate",
        "monthlyDueDate",
        "createdAt"
      ]
    },
    "Transaction": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Transaction",
      "type": "object",
      "description": "Represents a financial transaction, such as maintenance payment or expense.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the transaction."
        },
        "buildingId": {
          "type": "string",
          "description": "Reference to Building. (Relationship: Building 1:N Transaction)"
        },
        "memberId": {
          "type": "string",
          "description": "Reference to Member. (Relationship: Member 1:N Transaction)"
        },
        "type": {
          "type": "string",
          "description": "Type of transaction (maintenance, extra_collection, expense)."
        },
        "title": {
          "type": "string",
          "description": "Title or description of the transaction."
        },
        "amount": {
          "type": "number",
          "description": "Amount of the transaction."
        },
        "month": {
          "type": "string",
          "description": "Month for which the transaction is recorded."
        },
        "paymentMode": {
          "type": "string",
          "description": "Mode of payment used for the transaction."
        },
        "receiptNumber": {
          "type": "string",
          "description": "Unique receipt number for the transaction."
        },
        "paymentDate": {
          "type": "string",
          "description": "The date the payment was made.",
          "format": "date-time"
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the transaction was recorded.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "buildingId",
        "memberId",
        "type",
        "title",
        "amount",
        "month",
        "paymentMode",
        "receiptNumber",
        "paymentDate",
        "createdAt"
      ]
    },
    "Expense": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Expense",
      "type": "object",
      "description": "Represents an expense incurred for a building.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the expense."
        },
        "buildingId": {
          "type": "string",
          "description": "Reference to Building. (Relationship: Building 1:N Expense)"
        },
        "expenseType": {
          "type": "string",
          "description": "Type of expense (e.g., Light Bill, Lift Maintenance, etc.)."
        },
        "description": {
          "type": "string",
          "description": "Description of the expense."
        },
        "amount": {
          "type": "number",
          "description": "Amount of the expense."
        },
        "expenseDate": {
          "type": "string",
          "description": "Date when the expense was incurred.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "buildingId",
        "expenseType",
        "description",
        "amount",
        "expenseDate"
      ]
    },
    "ExpenseType": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Expense Type",
      "type": "object",
      "description": "Represents a category for expenses.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the expense type."
        },
        "name": {
          "type": "string",
          "description": "The name of the expense category (e.g., Lift Maintenance)."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp indicating when the type was created."
        }
      },
      "required": [
        "id",
        "name",
        "createdAt"
      ]
    },
    "ExtraCollection": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Extra Collection",
      "type": "object",
      "description": "Represents an extra collection for a specific purpose.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the extra collection."
        },
        "buildingId": {
          "type": "string",
          "description": "Reference to Building. (Relationship: Building 1:N ExtraCollection)"
        },
        "title": {
          "type": "string",
          "description": "Title or purpose of the collection."
        },
        "totalAmount": {
          "type": "number",
          "description": "The total amount to be collected."
        },
        "date": {
          "type": "string",
          "description": "Date of the collection.",
          "format": "date-time"
        },
        "paidMembers": {
          "type": "array",
          "description": "List of member IDs who have paid.",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "buildingId",
        "title",
        "totalAmount",
        "date"
      ]
    },
    "Due": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Due",
      "type": "object",
      "description": "Represents a specific due amount for a member.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the due."
        },
        "buildingId": {
          "type": "string",
          "description": "Reference to the Building."
        },
        "memberId": {
          "type": "string",
          "description": "Reference to the Member."
        },
        "title": {
          "type": "string",
          "description": "A descriptive title for the due."
        },
        "type": {
          "type": "string",
          "description": "The type or category of the due (e.g., 'Late Fee')."
        },
        "amount": {
          "type": "number",
          "description": "The amount of the due."
        },
        "dueDate": {
          "type": "string",
          "format": "date-time",
          "description": "The date by which the due should be paid."
        },
        "paymentDate": {
          "type": "string",
          "format": "date-time",
          "description": "The date the payment was made."
        },
        "status": {
          "type": "string",
          "enum": [
            "unpaid",
            "paid"
          ],
          "description": "The payment status of the due."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp indicating when the due was created."
        }
      },
      "required": [
        "id",
        "buildingId",
        "memberId",
        "title",
        "type",
        "amount",
        "dueDate",
        "status",
        "createdAt"
      ]
    },
    "DueType": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Due Type",
      "type": "object",
      "description": "Represents a category for dues.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the due type."
        },
        "name": {
          "type": "string",
          "description": "The name of the due category (e.g., Late Fee)."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp indicating when the type was created."
        }
      },
      "required": [
        "id",
        "name",
        "createdAt"
      ]
    },
    "UserProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User Profile",
      "type": "object",
      "description": "Represents a user's profile in the application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "The user's unique ID (from Firebase Auth)."
        },
        "fullName": {
          "type": "string",
          "description": "The user's full name."
        },
        "email": {
          "type": "string",
          "format": "email",
          "description": "The user's email address."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp indicating when the profile was created."
        }
      },
      "required": [
        "id",
        "fullName",
        "email",
        "createdAt"
      ]
    }
  },
  "auth": {
    "providers": [
      "password"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "UserProfile",
          "schema": {
            "$ref": "#/backend/entities/UserProfile"
          },
          "description": "Stores user profile information, accessible only by the owner.",
          "params": [
            {
              "name": "userId",
              "description": "Unique identifier for the user (Firebase Auth UID)."
            }
          ]
        }
      },
      {
        "path": "/buildings/{buildingId}",
        "definition": {
          "entityName": "Building",
          "schema": {
            "$ref": "#/backend/entities/Building"
          },
          "description": "Stores building details. Building acts as the top-level entity, and its ID is used to scope all related data.",
          "params": [
            {
              "name": "buildingId",
              "description": "Unique identifier for the building."
            }
          ]
        }
      },
      {
        "path": "/buildings/{buildingId}/members/{memberId}",
        "definition": {
          "entityName": "Member",
          "schema": {
            "$ref": "#/backend/entities/Member"
          },
          "description": "Stores member details for a specific building. Includes denormalized 'buildingId' for authorization independence.",
          "params": [
            {
              "name": "buildingId",
              "description": "Unique identifier for the building."
            },
            {
              "name": "memberId",
              "description": "Unique identifier for the member."
            }
          ]
        }
      },
      {
        "path": "/buildings/{buildingId}/transactions/{transactionId}",
        "definition": {
          "entityName": "Transaction",
          "schema": {
            "$ref": "#/backend/entities/Transaction"
          },
          "description": "Stores transaction details for a specific building and member. Includes denormalized 'buildingId' for authorization independence.",
          "params": [
            {
              "name": "buildingId",
              "description": "Unique identifier for the building."
            },
            {
              "name": "transactionId",
              "description": "Unique identifier for the transaction."
            }
          ]
        }
      },
      {
        "path": "/buildings/{buildingId}/expenses/{expenseId}",
        "definition": {
          "entityName": "Expense",
          "schema": {
            "$ref": "#/backend/entities/Expense"
          },
          "description": "Stores expense details for a specific building. Includes denormalized 'buildingId' for authorization independence.",
          "params": [
            {
              "name": "buildingId",
              "description": "Unique identifier for the building."
            },
            {
              "name": "expenseId",
              "description": "Unique identifier for the expense."
            }
          ]
        }
      },
      {
        "path": "/buildings/{buildingId}/extraCollections/{extraCollectionId}",
        "definition": {
          "entityName": "ExtraCollection",
          "schema": {
            "$ref": "#/backend/entities/ExtraCollection"
          },
          "description": "Stores extra collection details for a specific building.",
          "params": [
            {
              "name": "buildingId",
              "description": "Unique identifier for the building."
            },
            {
              "name": "extraCollectionId",
              "description": "Unique identifier for the extra collection."
            }
          ]
        }
      },
      {
        "path": "/expenseTypes/{expenseTypeId}",
        "definition": {
          "entityName": "ExpenseType",
          "schema": {
            "$ref": "#/backend/entities/ExpenseType"
          },
          "description": "Stores the list of available expense categories for all buildings.",
          "params": [
            {
              "name": "expenseTypeId",
              "description": "Unique identifier for the expense type."
            }
          ]
        }
      },
      {
        "path": "/dueTypes/{dueTypeId}",
        "definition": {
          "entityName": "DueType",
          "schema": {
            "$ref": "#/backend/entities/DueType"
          },
          "description": "Stores the list of available due categories for all buildings.",
          "params": [
            {
              "name": "dueTypeId",
              "description": "Unique identifier for the due type."
            }
          ]
        }
      },
      {
        "path": "/buildings/{buildingId}/dues/{dueId}",
        "definition": {
          "entityName": "Due",
          "schema": {
            "$ref": "#/backend/entities/Due"
          },
          "description": "Stores due details for a specific building and member.",
          "params": [
            {
              "name": "buildingId",
              "description": "Unique identifier for the building."
            },
            {
              "name": "dueId",
              "description": "Unique identifier for the due."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to enable secure and efficient CRUD operations for the BuildingWise application, focusing on authorization independence and clear access control.  The structure follows a hierarchical approach with Buildings at the top level, and Members, Transactions, Dues, and Expenses as subcollections.  This structure aligns with the principle of Path-Based Ownership where each entity is owned by the Building to which it belongs. All subcollections include the `buildingId` as a denormalized field.  This denormalization is CRITICAL for Authorization Independence, as it avoids `get()` calls in security rules to verify building ownership.  The structure supports the required QAPs by segregating data per building, which simplifies list operations (rules are not filters)."
  }
}
